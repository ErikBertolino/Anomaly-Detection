[PyTorch] GAN-Grad
=====

Implementation of GANomaly-GradCon Hybrid with MNIST dataset. This is really an amalgation of two different models: GANomaly and GradCon.

Currently, there is a problem with the amount of RAM needed to run the code. Better code or bigger computer is needed.

## Architecture
<div align="center">
  <img src="./figures/ganomaly.png" width="500">  
  <p>Simplified GANomaly architecture.</p>
</div>

## Graph in TensorBoard
<div align="center">
  <img src="./figures/graph.png" width="800">  
  <p>Graph of GANomaly.</p>
</div>

###How to run
<div align="center">
Clone this repository and run following commands to create a conda environment and install all dependencies.
```
	conda create -n GAN-Grad python=3.8
	conda activate GAN-Grad
	cd Anomaly-Detection
	conda install pytorch torchvision -c pytorch
	pip install -r requirments.txt
```
</div>

## Problem Definition
<div align="center">
  <img src="./figures/definition.png" width="600">  
  <p>'Class-1' is defined as normal and the others are defined as abnormal.</p>
</div>

##Method 
<div align="center">


	One may freely choose the split in the training/validation/test phases of the program. 
	
	Train:
	
	Validation:
	
	Test:
</div>

## Results
<div align="center">
	The results generated by this program is:
	<ul>
	<li>PCA plot of the latent space in the Autoencoder part</li>
	<li>Histograms for every term in the objective function, for normal and abnormal data</li>
	<li>Receiver operating characteristic and associated Area Under Curve</li>
	<li>Clustering of the L_grad, and associated classes.</li>
	<li>Box plot of loss for every class</li>
	</ul>
</div>


## Environment
* Python 3.7.4  
* PyTorch 1.1.0  
* Numpy 1.17.1  
* Matplotlib 3.1.1  
* Scikit Learn (sklearn) 0.21.3  

## Reference
[1] S Akcay, et al. (2018). <a href="https://arxiv.org/abs/1805.06725">Ganomaly: Semi-supervised anomaly detection via adversarial training.</a>.Â arXiv preprint arXiv:1805.06725.
[2] Kwon, Gukyeong and Prabhushankar (2020). <a href="https://arxiv.org/abs/2007.09507">Backpropagated Gradient Representations for Anomaly Detection</a>. arXiv preprint arXiv:2007.09507. 
